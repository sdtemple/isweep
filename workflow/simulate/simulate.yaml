# Seth D. Temple, sdtemple@uw.edu
# April 26, 2023

# change these
CHANGE:
  # folders, file name of simulation study *.tsv
  FOLDERS:
    MACRO: 'bottle' # folder for macro experiments
    MICRO: 'experiments/simstudy.test.tsv'
    SNAKESCRIPTS: '/projects/browning/brwnlab/seth/isweep-0.3.0/workflow/simulate/snakescripts/'
    TERMINALSCRIPTS: '/projects/browning/brwnlab/seth/isweep-0.3.0/workflow/simulate/terminalscripts/'
    SOFTWARE: '/projects/browning/brwnlab/seth/software/'
  PROGRAMS:
    SLiM: 'slim' # https://messerlab.org/slim/
  #  BEAGLE: 'beagle.05May22.33a.jar' # http://faculty.washington.edu/browning/
    HAPIBD: 'hap-ibd.jar' # https://github.com/browning-lab/hap-ibd
    IBDENDS: 'ibd-ends.jar' # https://github.com/browning-lab/ibd-ends
    GTERR: 'add-uniform-err.jar' # http://faculty.washington.edu/browning/
    # RMPHASE: 'remove-phase.jar' # http://faculty.washington.edu/browning/
    IBDNE: 'ibdne.23Apr20.ae9.jar' # http://faculty.washington.edu/browning/
    FILTER: 'filter-lines.jar' # http://faculty.washington.edu/browning/
  SIMULATE:
      tNe: 'ne/bottleneck.ne'
      ancNe: '10000'
      SAMPSIZE: '10000'
      MSPMAF: '0.001' # 0.001 for sequence data, >=0.01 for array data
      MIGRRATE: '0' # migration rate
      NUMSUBPOP: '1' # number of subpopulations

# keep these fixed
FIXED:
  # simulation study settings
  SIMULATE:
    CMLEN: '8' # in cM length, region size
    LOC: '3999999' # CMLEN / RHO / 100 - 1, location of adaptive mutation
    LEFT: '2799999' # left bound for focal region, say 1.2 Mb
    RIGHT: '5199999' # right bound for focal region, say 1.2 Mb
    RHO: '1e-8' # genome-wide recombination rate
    MU: '1e-8' # genome-wide mutation
    GCLEN: '300' # mean length of gene conversion
    GCPROP: '0.66666666666666' # proportion of recombinations that are crossovers
    SAMPLEONE: '1' # 1 to sample from all subpops, 0 otherwise
    SAMPLEEQUAL: '1' # 1 for equal sampling for subpops, 0 otherwise
    NUMVAR: '1' # num adaptive mutations
    PLOIDY: '2' # ploidy of species (adjust SLiM accordingly if not diploid)
    GTERR: '0.0002' # genotype errors
    TSPLIT: '1000' # time backwards of population split
    a: '0.1' # min adaptive allele freq
    b: '0.9' # min adaptive allele freq
  # hap-ibd.jar
  CANDHAPIBD:
    # min-seed
    MINSEED: '0.5'
    # min-extend
    MINEXT: '0.2'
    # min-output
    MINOUT: '1.0'
    # minimum minor allele frequency
    MINMAF: '0.40'
    # ploidy number
    PLOIDY: '2'
  # ibd-ends.jar
  IBDENDS:
    # quantiles from endpoint posterior
    QUANTILES: '0.5'
    # num samples from endpoint posterior
    NSAMPLES: '0'
    # do a test run on 1 chromosome to set this
    ERRRATE: '2e-4'
    # minimum minor allele frequency
    MINMAF: '0.001'
  # isweep
  ISWEEP:
    # in mega bp
    GENOMEEND: '1000'
    # in kilo bp
    BY: '20'
    # cutting cM at telomeres
    TELOCUT: '0.5'
    # ibd cM threshold for isweep method of moments
    MOMCUTOFF: '3.0'
    # ibd cM threshold for isweep scan
    SCANCUTOFF: '2.0'
  # hap-ibd for short
  HAPIBD:
    # min-seed
    MINSEED: '0.5'
    # min-extend
    MINEXT: '0.2'
    # min-output
    MINOUT: '1.0'
    # minimum minor allele frequency
    MINMAF: '0.10'
    # ploidy number
    PLOIDY: '2'

  # BROWNING:
  #   # candidate segments for ibd-ends.jar
  #   FIRSTHAP: # hap-ibd.jar
  #     MINSEED: '0.5' # min-seed
  #     MINEXT: '0.2' # min-extend
  #     MINOUT: '2.5' # min-output
  #     MINMAF: '0.40' # minimum minor allele frequency
  #   # ibd calls for selection scan
  #   FIRSTEND: # ibd-ends.jar
  #     QUANTILES: '0.5' # quantiles from endpoint posterior
  #     NSAMPLES: '0' # num samples from endpoint posterior
  #     ERRRATE: '1e-4' # do a test run to set this
  #     MINMAF: '0.001' # minimum minor allele frequency
  #   # ibd counts over windows
  #   FIRSTPASS:
  #     GENOMEEND: '10' # in mega bp
  #     BY: '20' # every 10 kilo bp
  #     TELOCUT: '0.5' # cutting cM at telomeres
  #     CUTOFF: '3.0' # ibd cM threshold for selection scan
  #   # long ibd calls
  #   SECONDHAP: # hap-ibd.jar
  #     MINSEED: '0.5' # min-seed
  #     MINEXT: '0.2' # min-extend
  #     MINMAF: '0.10' # controls min-mac
  #   # short ibd calls
  #   THIRDHAP:
  #     MINSEED: '0.5' # min-seed
  #     MINEXT: '0.2' # min-extend
  #     MINOUT: '1.0' # min-output
  #     MINMAF: '0.10' # controls min-mac
  #     MINMARK: '100' # min-markers

# ### iSWEEP SOFTWARE ###
# # https://github.com/sdtemple/iSWEEP
#
# ISWEEPPARAMS:
#   IBDCUTOFF: '3.0' # ibd cM threshold for method of moments
#   NBOOT: '50' # num bootstraps; for uncertainty quantification
#   IBDCOMMK: '1' # 2*K is max # edges for path connection -> for IBD community detection
#   IBDCOMMF: '0.00' # allele freq in labeled group 1 must exceed -> for IBD community detection, freq estimate
# # IBDCOMMA will also control hap-ibd min-mac
#   IBDCOMMA: '0.10' # nonmajor allele freq lower bound for focus region -> control memory
#   OUTLIERSCALAR: '3' # for IBD community detection
#   RANDSTATE: '11081959' # David Temple's birthday
#   IBDCOMMQ1: '0.15' # min allele freq to consider, should by and large match config[FIXED][a]
#   IBDCOMMQ2: '0.90' # max allele freq to consider, should by and large match config[FIXED][b]
#   DPI: '300' # dots per inch for figures
#   CONFPERC: '0.95' # like percent for confidence interval (actually based on quantiles)
